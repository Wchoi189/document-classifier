# WandB ì„¹ì…˜ - EfficientNetìš©ìœ¼ë¡œ ì—…ë°ì´íŠ¸
wandb:
  enabled: true
  project: "document-classifier"
  entity: null
  name: null
  tags: ["efficientnet-b3", "document-classification", "imbalanced", "transfer-learning"]
  notes: "17ê°œ í´ë˜ìŠ¤ ë¬¸ì„œ ë¶„ë¥˜ - EfficientNet-B3 with compound scaling"

  log_frequency: 10
  log_images: true
  log_model: true
  log_gradients: false
  log_confusion_matrix: true
  watch_model: true
  log_code: true

# ê¸°ë³¸ ì„¤ì •
seed: 42
device: 'cuda'

# ë°ì´í„° ì„¤ì • - EfficientNetì— ìµœì í™”
data:
  root_dir: "data/dataset"
  csv_file: "data/dataset/train.csv"
  meta_file: "data/dataset/meta.csv"
  image_size: 300  # EfficientNet-B3 ê¶Œì¥ í¬ê¸° (224â†’300ìœ¼ë¡œ ì¦ê°€)
  val_size: 0.2
  num_workers: 4   # EfficientNetì€ ë” ë§ì€ ì›Œì»¤ë¡œ ì²˜ë¦¬ ê°€ëŠ¥
  # EfficientNetìš© ì •ê·œí™” (ImageNet ì‚¬ì „í›ˆë ¨ ê¸°ì¤€)
  mean: [0.485, 0.456, 0.406]
  std: [0.229, 0.224, 0.225]
  use_document_augmentation: true  # ë¬¸ì„œ íŠ¹í™” ì¦ê°• í™œì„±í™”

  # ë¬¸ì„œ íŠ¹í™” ì¦ê°• ì„¤ì •
   # ì¦ê°• ì„¸ë¶€ ì„¤ì •
 #  AUGMENTATIONS SHOULD BE A SEPARATE, TOP-LEVEL SECTION
augmentations:
  # Geometric Transformations
  geom_probability: 0.5        # Probability for the entire geometric block
  rotation_limit: 8
  perspective_scale: 0.05
  shift_scale_rotate: true
  
  # Lighting and Color
  color_probability: 0.4       # Probability for the entire color block
  brightness_contrast: true    # Use RandomBrightnessContrast
  brightness_limit: 0.15
  contrast_limit: 0.15
  gamma_correction: true       # Use RandomGamma
  
  # Noise and Quality
  noise_probability: 0.3       # Probability for the entire noise block
  gaussian_noise: true         # Use GaussNoise
  noise_variance: [5.0, 15.0]
  jpeg_compression: true       # Use ImageCompression
  compression_quality: [75, 95]
  
  # Augraphy Settings (if available)
  use_augraphy: true
  augraphy_probability: 0.6    # Overall probability for applying any Augraphy effect
  paper_effects: 0.3
  ink_effects: 0.4
  scan_effects: 0.3
  
# ëª¨ë¸ ì„¤ì • - EfficientNet
model:
  name: "efficientnet-b3"     # B0~B7 ì¤‘ ì„ íƒ (B3 ê¶Œì¥: ì„±ëŠ¥/ì†ë„ ê· í˜•)
  pretrained: true
  dropout_rate: 0.3           # EfficientNet ë“œë¡­ì•„ì›ƒ ë¹„ìœ¨
  drop_connect_rate: 0.2      # Stochastic Depth
  
  # ëŒ€ì•ˆ ëª¨ë¸ë“¤ (ì£¼ì„ ì²˜ë¦¬)
  # name: "efficientnet-b0"   # ë¹ ë¥¸ ì‹¤í—˜ìš©
  # name: "efficientnet-b4"   # ë” ë†’ì€ ì„±ëŠ¥ ì›í•  ë•Œ
  # name: "efficientnet-b5"   # ìµœê³  ì„±ëŠ¥ (ë©”ëª¨ë¦¬ ë§ì´ í•„ìš”)

# í•™ìŠµ ì„¤ì • - EfficientNet ìµœì í™”
train:
  use_amp: true               # Mixed Precision (EfficientNetì— íš¨ê³¼ì )
  epochs: 24                  # EfficientNetì€ ë” ë§ì€ ì—í¬í¬ í•„ìš”
  batch_size: 24              # B3 ê¸°ì¤€ (GPU ë©”ëª¨ë¦¬ì— ë”°ë¼ ì¡°ì •)
  
  # ì˜µí‹°ë§ˆì´ì € - EfficientNet ë…¼ë¬¸ ê¸°ì¤€
  optimizer: 'RMSprop'        # ì›ë…¼ë¬¸ì—ì„œ ì‚¬ìš©í•œ ì˜µí‹°ë§ˆì´ì €
  learning_rate: 0.016        # ë°°ì¹˜ í¬ê¸°ì— ë¹„ë¡€ ì¡°ì •
  weight_decay: 0.00001       # L2 ì •ê·œí™”
  momentum: 0.9               # RMSprop ëª¨ë©˜í…€
  
  # ëŒ€ì•ˆ ì˜µí‹°ë§ˆì´ì € (ë” ì•ˆì •ì )
  # optimizer: 'AdamW'
  # learning_rate: 0.001
  # weight_decay: 0.01
  
  loss: 'CrossEntropyLoss'
  
  # ë¼ë²¨ ìŠ¤ë¬´ë”© (EfficientNet ë…¼ë¬¸ì—ì„œ ì‚¬ìš©)
  label_smoothing: 0.1
  
   # ìŠ¤ì¼€ì¤„ëŸ¬ - EfficientNet ìµœì í™”
  scheduler: 'CosineAnnealingWarmRestarts'
  scheduler_params:
    T_0: 10                   # ì²« ë²ˆì§¸ ì¬ì‹œì‘ê¹Œì§€ ì—í¬í¬
    T_mult: 2                 # ì¬ì‹œì‘ ì£¼ê¸° ë°°ìˆ˜
    eta_min: 0.00001         # ìµœì†Œ í•™ìŠµë¥ 
    
  # ëŒ€ì•ˆ ìŠ¤ì¼€ì¤„ëŸ¬ (ë” ì•ˆì •ì )
  # scheduler: 'ReduceLROnPlateau'
  # scheduler_params:
  #   mode: 'max'
  #   factor: 0.5
  #   patience: 5
  #   min_lr: 0.00001

  # ì¡°ê¸° ì¢…ë£Œ ì„¤ì •
  early_stopping:
    patience: 8               # EfficientNetì€ ë” ê¸´ patience í•„ìš”
    metric: 'val_f1'
    mode: 'max'
    min_delta: 0.001         # ìµœì†Œ ê°œì„  ì„ê³„ê°’

  # EfficientNet íŠ¹í™” ì„¤ì •
  gradient_clipping: 1.0      # ê·¸ë˜ë””ì–¸íŠ¸ í´ë¦¬í•‘
  ema_decay: 0.9999          # Exponential Moving Average (ì„ íƒì‚¬í•­)

# ë¡œê¹… ë° ì €ì¥ ê²½ë¡œ
logging:
  log_dir: "logs/efficientnet"
  checkpoint_dir: "checkpoints/efficientnet"
  log_interval: 10
  memory_logging: true
  
  # ì¶”ê°€ ë¡œê¹…
  log_lr: true               # í•™ìŠµë¥  ë³€í™” ë¡œê¹…
  log_gradients: false       # ê·¸ë˜ë””ì–¸íŠ¸ norm ë¡œê¹…
  save_best_only: true       # ìµœê³  ì„±ëŠ¥ ëª¨ë¸ë§Œ ì €ì¥

# í´ë˜ìŠ¤ ë¶ˆê· í˜• ì²˜ë¦¬ (ì„ íƒì‚¬í•­)
class_balancing:
  use_weighted_loss: false    # ê°€ì¤‘ì¹˜ ì†ì‹¤ ì‚¬ìš© ì—¬ë¶€
  use_focal_loss: false       # Focal Loss ì‚¬ìš© ì—¬ë¶€
  focal_alpha: 1.0           # Focal Loss alpha
  focal_gamma: 2.0           # Focal Loss gamma
  
  # ìƒ˜í”Œë§ ì „ëµ
  use_weighted_sampling: false # ê°€ì¤‘ì¹˜ ìƒ˜í”Œë§
  oversample_minority: false   # ì†Œìˆ˜ í´ë˜ìŠ¤ ì˜¤ë²„ìƒ˜í”Œë§

# í…ŒìŠ¤íŠ¸ ì‹œê°„ ì¦ê°• (TTA)
test_time_augmentation:
  enabled: false             # TTA ì‚¬ìš© ì—¬ë¶€
  num_augments: 5           # ì¦ê°• íšŸìˆ˜
  augment_types: ['rotation', 'brightness', 'perspective']



# # ğŸŸ¢ 8GB GPU (GTX 1080, RTX 2070 ë“±)
# model:
#   name: "efficientnet-b0"
# data:
#   image_size: 224
# train:
#   batch_size: 24
#   use_amp: true

# # ğŸŸ¡ 12GB GPU (RTX 3080, RTX 4070 Ti ë“±)  
# model:
#   name: "efficientnet-b3"     # ê¶Œì¥ â­
# data:
#   image_size: 300
# train:
#   batch_size: 16
#   use_amp: true

# # ğŸ”´ 16GB+ GPU (RTX 3090, RTX 4080 ë“±)
# model:
#   name: "efficientnet-b4"
# data:
#   image_size: 380
# train:
#   batch_size: 12
#   use_amp: true

